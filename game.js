var Block=cc.LayerColor.extend({ctor:function(e,c,n,i){return this._super(cc.color(255,0,0,255),n,i),this.x=e,this.y=c,!0}}),FieldLayer=cc.Layer.extend({_ship:null,_block:null,ctor:function(){this._super()},init:function(){this._super();{var e=cc.director.getWinSize();cc.p(e.width/2,e.height/2)}_block=new Block(e.width,0,30,200),this.addChild(_block),_ship=new Ship,this.addChild(_ship),cc.eventManager.addListener({event:cc.EventListener.TOUCH_ONE_BY_ONE,swallowTouches:!0,onTouchBegan:this.onTouch},this),this.scheduleUpdate()},onTouch:function(){_ship.onTouch()},update:function(){_block.x-=1;var e=_ship.getBoundingBox(),c=_block.getBoundingBox();cc.rectIntersectsRect(e,c)&&_ship.gameOver()}}),GameLayer=cc.Layer.extend({ctor:function(){this._super()},init:function(){this._super();var e=cc.director.getWinSize(),c=cc.p(e.width/2,e.height/2),n=new cc.Sprite(res.background);n.setPosition(c),this.addChild(n)}}),GameOverLayer=cc.Layer.extend({ctor:function(){this._super()},init:function(){this._super();var e=cc.director.getWinSize(),c=cc.p(e.width/2,e.height/2),n=new cc.Sprite(res.background);n.setPosition(c),this.addChild(n);var i=new cc.MenuItemLabel(new cc.LabelTTF("restart","Arial",30),this.onPlay,this),t=new cc.Menu;t.addChild(i),t.setPosition(c),this.addChild(t)},onPlay:function(){cc.log("==onplay clicked"),cc.director.runScene(new GameScene)}}),GameOverScene=cc.Scene.extend({onEnter:function(){this._super();var e=new GameOverLayer;e.init(),this.addChild(e)}}),GameScene=cc.Scene.extend({onEnter:function(){this._super();var e=new GameLayer;e.init(),this.addChild(e,0);var c=new FieldLayer;c.init(),this.addChild(c,1)}});window.onload=function(){cc.game.onStart=function(){cc.LoaderScene.preload(g_resources,function(){cc.director.runScene(new MenuScene)},this)},cc.game.run("gameCanvas")};var MenuLayer=cc.Layer.extend({ctor:function(){this._super()},init:function(){this._super();var e=cc.director.getWinSize(),c=cc.p(e.width/2,e.height/2),n=new cc.Sprite(res.background);n.setPosition(c),this.addChild(n);var i=new cc.MenuItemLabel(new cc.LabelTTF("start","Arial",30),this.onPlay,this),t=new cc.Menu;t.addChild(i),t.setPosition(c),this.addChild(t)},onPlay:function(){cc.log("==onplay clicked"),cc.director.runScene(new GameScene)}}),MenuScene=cc.Scene.extend({onEnter:function(){this._super();var e=new MenuLayer;e.init(),this.addChild(e)}}),res={background:"res/background.png",chara:"res/chara.png"},g_resources=[res.background,res.chara],Ship=cc.Sprite.extend({appearPosition:cc.p(160,240),vy:4,ctor:function(){this._super(res.chara),this.x=this.appearPosition.x,this.y=this.appearPosition.y,this.scheduleUpdate()},update:function(){this.y>0?(this.y=this.y+this.vy,this.vy+=-.25):this.gameOver()},onTouch:function(){console.log("touch"),this.vy=6},gameOver:function(){cc.director.runScene(new GameOverScene)}});